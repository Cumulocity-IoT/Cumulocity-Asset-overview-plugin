const secrets = new WeakMap();
export class BearerAuth {
    constructor(token) {
        secrets.set(this, { token });
    }
    getFetchOptions(options) {
        const secret = secrets.get(this);
        const { token } = secret;
        options.headers = Object.assign({ Authorization: `Bearer ${token}` }, options.headers);
        return options;
    }
    updateCredentials({ token }) {
        secrets.set(this, { token });
        return;
    }
    getCometdHandshake(config = {}) {
        const secret = secrets.get(this);
        const { token, tfa } = secret;
        const KEY = 'com.cumulocity.authn';
        const ext = (config.ext = config.ext || {});
        ext[KEY] = Object.assign(ext[KEY] || {}, { token, tfa });
        return config;
    }
    logout() {
        secrets.set(this, {});
    }
}
//# sourceMappingURL=BearerAuth.js.map